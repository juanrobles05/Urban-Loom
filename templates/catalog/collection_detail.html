{% extends 'base.html' %}
{% load static %}

{% block title %}{{ collection.name }} - {{ collection.season }} - Urban Loom{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/collections.css' %}">
{% endblock %}

{% block content %}
<div class="min-h-screen bg-black text-white">
    <!-- Collection Header -->
    <section class="py-20 bg-gray-900 px-4">
        <div class="container mx-auto px-6">
            <div class="max-w-6xl mx-auto">
                <div class="grid md:grid-cols-2 gap-12 items-center">
                    <!-- Collection Image -->
                    <div class="order-2 md:order-1">
                        {% if collection.image %}
                            <img src="{{ collection.image.url }}" alt="{{ collection.name }}" class="w-full h-80 object-cover rounded-lg shadow-2xl">
                        {% else %}
                            <div class="w-full h-80 bg-gray-800 flex items-center justify-center rounded-lg shadow-2xl">
                                <img src="{% static 'img/Logo.png' %}"
                                     alt="Urban Loom Logo"
                                     class="w-24 h-24 object-contain opacity-60">
                            </div>
                        {% endif %}
                    </div>

                    <!-- Collection Information -->
                    <div class="order-1 md:order-2 text-center md:text-left">
                        <!-- Collection Title Section -->
                        <div class="mb-12">
                            <span class="text-gray-400 text-sm font-bold tracking-wide uppercase">{{ collection.season }}</span>
                            <h1 class="text-4xl md:text-6xl font-bold mt-4 mb-6">{{ collection.name }}</h1>
                            <p class="text-lg text-gray-300 leading-relaxed">{{ collection.description }}</p>
                        </div>

                        <!-- Collection Stats -->
                        <div class="flex justify-center md:justify-start items-center gap-8 mb-8">
                            <div class="text-center md:text-left">
                                <span class="text-3xl font-bold block">{{ collection.pieces }}</span>
                                <p class="text-gray-400 text-sm font-medium tracking-wide">TOTAL PIECES</p>
                            </div>
                            <div class="w-px h-12 bg-gray-600"></div>
                            <div class="text-center md:text-left">
                                <span class="text-3xl font-bold block">{{ collection.season }}</span>
                                <p class="text-gray-400 text-sm font-medium tracking-wide">SEASON</p>
                            </div>
                        </div>

                        <!-- Status and Back Button -->
                        <div class="flex flex-col items-center md:items-start gap-4">
                            <span class="{{ collection.get_status_color|default:'bg-gray-500' }} text-white px-6 py-2 text-sm font-bold rounded-full uppercase tracking-wide">
                                {{ collection.status }}
                            </span>
                            <a href="{% url 'catalog:collections' %}" class="bg-white text-black px-8 py-3 font-bold hover:bg-gray-200 transition-colors duration-300 rounded">
                                ‚Üê BACK TO COLLECTIONS
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Grid -->
    <section class="py-20 bg-black">
        <div class="container mx-auto px-6">
            <h2 class="text-4xl md:text-5xl font-bold text-center mb-16">COLLECTION PIECES</h2>
            {% if products %}
                <div class="grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                    {% for product in products %}
                    <a href="{% url 'catalog:product_detail' product.id %}" class="group block cursor-pointer">
                        <div class="relative overflow-hidden rounded-lg mb-4">
                            {% if product.image %}
                                <img src="{{ product.image.url }}" alt="{{ product.name }}" class="w-full h-80 object-cover transition-transform duration-500 group-hover:scale-110">
                            {% else %}
                                <div class="w-full h-80 bg-gray-800 flex items-center justify-center transition-transform duration-500 group-hover:scale-110">
                                    <span class="text-gray-500">{{ product.name }}</span>
                                </div>
                            {% endif %}
                            <!-- Wishlist Button -->
                            <form method="post" action="{% url 'recommendations:add_to_wishlist' product.id %}" class="inline-block absolute top-4 left-4 z-10">
                                {% csrf_token %}
                                <button type="submit" class="hover:bg-primary/10 rounded-full p-2" aria-label="Add to Wishlist">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                      <path d="M12 6.00019C10.2006 3.90317 7.19377 3.2551 4.93923 5.17534C2.68468 7.09558 2.36727 10.3061 4.13778 12.5772C5.60984 14.4654 10.0648 18.4479 11.5249 19.7369C11.6882 19.8811 11.7699 19.9532 11.8652 19.9815C11.9483 20.0062 12.0393 20.0062 12.1225 19.9815C12.2178 19.9532 12.2994 19.8811 12.4628 19.7369C13.9229 18.4479 18.3778 14.4654 19.8499 12.5772C21.6204 10.3061 21.3417 7.07538 19.0484 5.17534C16.7551 3.2753 13.7994 3.90317 12 6.00019Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </button>
                            </form>
                            <div class="absolute inset-0 bg-black bg-opacity-40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                                <span class="text-white text-lg font-bold">VIEW PRODUCT</span>
                            </div>
                            {% if product.stock < 5 and product.stock > 0 %}
                            <div class="absolute top-4 right-4">
                                <span class="bg-yellow-500 text-black px-3 py-1 text-xs font-bold rounded">LOW STOCK</span>
                            </div>
                            {% elif product.stock == 0 %}
                            <div class="absolute top-4 right-4">
                                <span class="bg-red-500 text-white px-3 py-1 text-xs font-bold rounded">SOLD OUT</span>
                            </div>
                            {% endif %}
                        </div>
                        <h3 class="text-lg font-bold mb-2">{{ product.name }}</h3>
                        <p class="text-gray-300 text-sm mb-2">{{ product.description|truncatewords:10 }}</p>
                        <p class="text-white font-bold">${{ product.price|floatformat:0 }} COP</p>
                    </a>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-center py-16">
                    <p class="text-gray-400 text-xl">No products available in this collection yet.</p>
                    <p class="text-gray-500 text-sm mt-2">Check back soon for new additions.</p>
                </div>
            {% endif %}
        </div>
    </section>
</div>
{% endblock %}
